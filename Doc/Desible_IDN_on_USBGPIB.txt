import pyvisa
rm = pyvisa.ResourceManager()
rm_list = rm.list_resources()
print(rm_list)
('USB0::0x03EB::0x2065::_IDN_EM_TEST__AutoWave__0__5.10.08__2__0::INSTR', 'USB0::0x03EB::0x2065::Agilent_Technologies_N6700B_MY43014421_D.04.09::INSTR', 'ASRL16::INSTR', 'ASRL3::INSTR', 'USB0::0x03EB::0x2065::Agilent_Technologies_N6700B_MY43014421_D.04.09::0::INSTR', 'USB0::0x03EB::0x2065::GPIB_01_5513730303135190A140::0::INSTR', 'USB0::0x03EB::0x2065::GPIB_10_5513730303135190A140::0::INSTR', 'USB0::0x03EB::0x2065::HP0.87300MZ_AP20.0DB_EMOF_COOF_CO0_AP50_MS01_AM30.::0::INSTR', 'USB0::0x0957::0x0407::MY44048527::0::INSTR', 'USB0::0x0957::0x0907::MY43014421::0::INSTR', 'USB0::0x0957::0x0A07::MY48001027::0::INSTR', 'USB0::0x0957::0x172D::MY50340210::0::INSTR', 'USB0::0x0957::0x1798::MY59124127::0::INSTR', 'USB0::0x0957::0x17A0::MY53260390::0::INSTR', 'USB0::0x0957::0x17A4::MY53280472::0::INSTR', 'USB0::0x0957::0x17A4::MY53280561::0::INSTR', 'USB0::0x0957::0x17A4::MY53280562::0::INSTR')
VM = rm.open_resource('USB0::0x03EB::0x2065::Agilent_Technologies_N6700B_MY43014421_D.04.09::INSTR')
VM.control_in(0xa1, 0x40, 0, 0)
b''
VM.write('!0001')
make a power cycle 